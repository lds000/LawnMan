<UserControl x:Class="BackyardBoss.Views.ProgramEditorView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:vm="clr-namespace:BackyardBoss.ViewModels"
             xmlns:viewModels="clr-namespace:BackyardBoss.ViewModels"

             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:usercontrols="clr-namespace:BackyardBoss.UserControls"
             mc:Ignorable="d"
             Background="#111111">
    <UserControl.DataContext>
        <vm:ProgramEditorViewModel />
    </UserControl.DataContext>

    <UserControl.Resources>
        <!-- Title TextBlock Style -->
        <Style x:Key="TitleTextBlockStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="20"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Margin" Value="0,0,0,10"/>
        </Style>
        <ControlTemplate x:Key="EmptyButtonTemplate" TargetType="RepeatButton">
            <Border Background="Transparent" BorderThickness="0" />
        </ControlTemplate>
        <Style x:Key="TouchSliderStyle" TargetType="Slider">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderBrush" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Slider">
                        <Grid>
                            <!-- Background track line -->
                            <Rectangle Height="3"
                               Fill="White"
                               VerticalAlignment="Center"
                               
                               HorizontalAlignment="Stretch"
                               Margin="20,0" />

                            <!-- Slider mechanics -->
                            <Track x:Name="PART_Track"
                           VerticalAlignment="Center"
                           Focusable="False">
                                <Track.DecreaseRepeatButton>
                                    <RepeatButton IsEnabled="False"
                                          Template="{StaticResource EmptyButtonTemplate}" />
                                </Track.DecreaseRepeatButton>

                                <Track.Thumb>
                                    <Thumb Width="40" Height="40">
                                        <Thumb.Template>
                                            <ControlTemplate TargetType="Thumb">
                                                <Ellipse Width="40" Height="40"
                                                 Fill="Black"
                                                 Stroke="White"
                                                 StrokeThickness="2" />
                                            </ControlTemplate>
                                        </Thumb.Template>
                                    </Thumb>
                                </Track.Thumb>

                                <Track.IncreaseRepeatButton>
                                    <RepeatButton IsEnabled="False"
                                          Template="{StaticResource EmptyButtonTemplate}" />
                                </Track.IncreaseRepeatButton>
                            </Track>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>



    </UserControl.Resources>


    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <!-- Header with Clock and Season Slider -->
        <DockPanel Grid.Row="0" Margin="0,0,0,20">
            <TextBlock Style="{StaticResource TitleTextBlockStyle}"
                       Text="Seasonal Adj (%):"
                        VerticalAlignment="Center" />
            <Slider Width="200"
                    Style="{StaticResource TouchSliderStyle}"
                    
            Minimum="50" Maximum="200"
            TickFrequency="10"
            IsSnapToTickEnabled="True"
            Value="{Binding SeasonalAdjustmentPercent, Mode=TwoWay}" />
            <TextBlock Text="{Binding SeasonalAdjustmentPercent, StringFormat={}{0}%}"
               Style="{StaticResource TitleTextBlockStyle}" VerticalAlignment="Center"/>
        </DockPanel>

        <!-- Main Panel -->
        <StackPanel Grid.Row="1" Orientation="Vertical">
            <!-- Zone Controls -->
            <StackPanel Orientation="Vertical" Margin="0,0,0,20">
                <TextBlock Text="Zone Durations"
               Style="{StaticResource TitleTextBlockStyle}" />

                <ItemsControl ItemsSource="{Binding Sets}">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <StackPanel Orientation="Vertical" Margin="0,0,0,10">
                                <!-- Zone Label with current value -->
                                <TextBlock FontSize="16" Foreground="White">
    <Run Text="{Binding SetName}" />
    <Run Text=" (" />
    <Run Text="{Binding RunDurationMinutes}" />
    <Run Text="m → " />
    <Run Text="{Binding SeasonallyAdjustedMinutes, Mode=OneWay}" />

    <Run Text="m)" />
                                </TextBlock>


                                <!-- Simple Slider (no labels) -->
                                <Slider Minimum="0" Maximum="30"
                                        Style="{StaticResource TouchSliderStyle }"
                        TickFrequency="1"
                        IsSnapToTickEnabled="True"
                        TickPlacement="BottomRight"
                        Value="{Binding RunDurationMinutes, Mode=TwoWay}"
                        HorizontalAlignment="Stretch"
                        Margin="0"
                        Height="50"/>
                            </StackPanel>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>

            </StackPanel>


            <!-- Two Week Scheduler (14 Toggle Grids) -->
            <StackPanel Orientation="Vertical" Margin="0,0,0,20">
                <TextBlock Text="Schedule Days (2 Weeks)" Style="{StaticResource ResourceKey=TitleTextBlockStyle}" />
                <UniformGrid Rows="2" Columns="7" Margin="0,5">
                    <ToggleButton Content="Sun 1" IsChecked="{Binding Week1Sunday}" />
                    <ToggleButton Content="Mon 1" IsChecked="{Binding Week1Monday}" />
                    <ToggleButton Content="Tue 1" IsChecked="{Binding Week1Tuesday}" />
                    <ToggleButton Content="Wed 1" IsChecked="{Binding Week1Wednesday}" />
                    <ToggleButton Content="Thu 1" IsChecked="{Binding Week1Thursday}" />
                    <ToggleButton Content="Fri 1" IsChecked="{Binding Week1Friday}" />
                    <ToggleButton Content="Sat 1" IsChecked="{Binding Week1Saturday}" />
                </UniformGrid>
                <UniformGrid Rows="2" Columns="7">
                    <ToggleButton Content="Sun 2" IsChecked="{Binding Week2Sunday}" />
                    <ToggleButton Content="Mon 2" IsChecked="{Binding Week2Monday}" />
                    <ToggleButton Content="Tue 2" IsChecked="{Binding Week2Tuesday}" />
                    <ToggleButton Content="Wed 2" IsChecked="{Binding Week2Wednesday}" />
                    <ToggleButton Content="Thu 2" IsChecked="{Binding Week2Thursday}" />
                    <ToggleButton Content="Fri 2" IsChecked="{Binding Week2Friday}" />
                    <ToggleButton Content="Sat 2" IsChecked="{Binding Week2Saturday}" />
                </UniformGrid>
            </StackPanel>

            <!-- Start Times with RadialTimePickers -->
            <StackPanel Orientation="Vertical">
                <TextBlock Text="Start Times" Style="{StaticResource TitleTextBlockStyle}" />


                <ItemsControl ItemsSource="{Binding StartTimes}">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <StackPanel Orientation="Horizontal" Margin="0,5">
                                <TextBox Width="100" Text="{Binding Time, Mode=TwoWay}" Margin="5" />
                                <Button Content="Pick Time"
                        Width="100"
                        Command="{Binding DataContext.OpenTimePickerCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                        CommandParameter="{Binding}" />
                            </StackPanel>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </StackPanel>
        </StackPanel>

        <!-- Footer Buttons -->
        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,20,0,0">
            <Button Content="Auto" Width="100" Height="40" Margin="5,0" />
            <Button Content="Off" Width="100" Height="40" Margin="5,0" />
            <Button Content="Run Once" Width="100" Height="40" Margin="5,0" />
            <Button Content="Reset" Width="100" Height="40" Background="DarkRed" Foreground="White" Margin="5,0" />
        </StackPanel>
    </Grid>
</UserControl>
